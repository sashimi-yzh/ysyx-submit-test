From 05c7d80ea455427baf6d2e39e0e7e1e709e56690 Mon Sep 17 00:00:00 2001
From: EPTansuo <eptansuo@163.com>
Date: Thu, 12 Dec 2024 13:59:57 +0800
Subject: [PATCH 10/23] add assert for psram cmd

---
 src/device/PSRAM.scala | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/device/PSRAM.scala b/src/device/PSRAM.scala
index cc783af4e..682c9b27b 100644
--- a/src/device/PSRAM.scala
+++ b/src/device/PSRAM.scala
@@ -141,7 +141,10 @@ class psramChisel extends RawModule {
   
   dontTouch(dout)
   withClockAndReset(io.sck.asClock, io.ce_n.asBool) {
-   //assert(((cmd === 0xEB.U) || (cmd === 0x38.U)) ^ (state === s_addr), "Invalid cmd: Only support 0xEB and 0x38!" )
+    when(state === s_wait || state === s_data){
+      assert(((cmd === 0xEB.U) || (cmd === 0x38.U)) , "Invalid cmd: Only support 0xEB and 0x38!" )
+    }
+
   }
   
 }
-- 
2.51.0

