mainmenu "NPC Configuration Menu"

config ISA
  string "Instruction Set Architecture"
  default riscv32e 

choice
  prompt "NPC Backend"
  default NPC_VERILOG
config NPC_VERILOG
  bool "npc"
config NPC_CHISEL
  bool "npc-chisel"
endchoice

config NVBOARD
  bool "nvboard enable"
  default n

config IVERILOG
  bool "iverilog enable"
  default n

config PIPELINE_PC
  bool "pipline enable"
  default y

config SOC
  bool "run with/without soc"
  default y

config PC_REPEAT_COUNT
  bool "Enable pc repeat count"
  default n

config PC_MAX_REPEAT
  depends on PC_REPEAT_COUNT
  int "same pc repeat max times"
  default 4096

menu "Testing and Debugging"

config TRACE
  bool "Enable tracer"
  default y

config TRACE_START
  depends on TRACE
  int "When tracing is enabled (unit: number of instructions)"
  default 0

config TRACE_END
  depends on TRACE
  int "When tracing is disabled (unit: number of instructions)"
  default 10000

config WAVETRACE
  depends on TRACE
  bool "Enable wave trace"
  default y

choice
  prompt "gtkwave format"
  default WAVETRACE_FST
  depends on WAVETRACE
config WAVETRACE_FST
  bool "fst"
config WAVETRACE_VCD
  bool "vcd"
endchoice

config ITRACE
  depends on TRACE 
  bool "Enable instruction tracer"
  default y

config ITRACE_COND
  depends on ITRACE
  string "Only trace instructions when the condition is true"
  default "true"

# config MTRACE
#   depends on TRACE 
#   bool "Enable memory tracer"
#   default n

# config MTRACE_COND
#   depends on ITRACE
#   string "Only trace memory when the condition is true"
#   default "true"

# config FTRACE
#   depends on TRACE && TARGET_NATIVE_ELF && ENGINE_INTERPRETER
#   bool "Enable function tracer"
#   default n

# config FTRACE_COND
#   depends on ITRACE
#   string "Only trace function when the condition is true"
#   default "true"

# config DTRACE
#   depends on TRACE && TARGET_NATIVE_ELF && ENGINE_INTERPRETER
#   bool "Enable device tracer"
#   default n

# config DTRACE_COND
#   depends on ITRACE
#   string "Only trace device when the condition is true"
#   default "true"

config WATCH_TOP
  depends on TRACE
  bool "watch top inst when the condition is true"
  default y

config WATCHPOINT
  depends on TRACE
  bool "Enable watchpoint when the condition is true"
  default n

config DIFFTEST
  depends on TRACE
  bool "Enable differential testing"
  default n
  help
    Enable differential testing with a reference design.
    Note that this will significantly reduce the performance of NEMU.

choice
  prompt "Reference design"
  default DIFFTEST_REF_NEMU
  depends on DIFFTEST
config DIFFTEST_REF_NEMU
  bool "nemu"
#if ISA_riscv
#config DIFFTEST_REF_SPIKE
#  bool "Spike"
#endif
endchoice

config DIFFTEST_REF_PATH
  string
  default "" if DIFFTEST_REF_NEMU
  default "none"

config DIFFTEST_REF_NAME
  string
  default "nemu" if DIFFTEST_REF_NEMU
  default "none"

endmenu

source "csrc/device/Kconfig"
source "csrc/memory/Kconfig"
